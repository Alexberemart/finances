<h2>Subir archivo XLSX</h2>
<div class="upload-section">
  <!-- BBVA Button -->
  <button mat-raised-button color="primary" (click)="bbvaFileInput.click()">
    <mat-icon>upload</mat-icon>
    Cargar fichero BBVA
  </button>
  <input #bbvaFileInput type="file" accept=".xlsx" (change)="onFileSelected($event)" hidden />

  <!-- ING Button -->
  <button mat-raised-button color="primary" (click)="ingFileInput.click()">
    <mat-icon>upload</mat-icon>
    Cargar fichero ING
  </button>
  <input #ingFileInput type="file" accept=".xlsx" (change)="onIngFileSelected($event)" hidden />

  <span *ngIf="selectedFileName" class="file-name">{{ selectedFileName }}</span>
</div>

<button mat-raised-button color="accent" (click)="onSave()" [disabled]="importData.length === 0">
  <mat-icon>save</mat-icon>
  Guardar borrador
</button>

<button mat-raised-button color="primary"
        (click)="onRegisterNotSkipped()"
        [disabled]="!hasNotSkippedMovements">
  <mat-icon>check_circle</mat-icon>
  Registrar movimientos seleccionados
</button>

<button mat-raised-button color="primary" (click)="loadDraftMovements()">
  <mat-icon>cloud_download</mat-icon>
  Cargar borrador guardado
</button>

<mat-table *ngIf="importData.length > 0" [dataSource]="importData" class="mat-elevation-z2">

  <ng-container matColumnDef="skip">
    <mat-header-cell *matHeaderCellDef> No registrar </mat-header-cell>
    <mat-cell *matCellDef="let row">
      <mat-checkbox [(ngModel)]="row.skip"></mat-checkbox>
    </mat-cell>
  </ng-container>

  <ng-container matColumnDef="date">
    <mat-header-cell *matHeaderCellDef> Fecha </mat-header-cell>
    <mat-cell *matCellDef="let row"> {{ row.date | date:'dd/MM/yyyy' }} </mat-cell>
  </ng-container>

  <ng-container matColumnDef="description">
    <mat-header-cell *matHeaderCellDef> Descripci√≥n </mat-header-cell>
    <mat-cell *matCellDef="let row"> {{ row.description }} </mat-cell>
  </ng-container>

  <ng-container matColumnDef="amount">
    <mat-header-cell *matHeaderCellDef> Importe </mat-header-cell>
    <mat-cell *matCellDef="let row"> {{ row.amount | number:'1.2-2' }} </mat-cell>
  </ng-container>

  <ng-container matColumnDef="label">
    <mat-header-cell *matHeaderCellDef> Etiqueta </mat-header-cell>
    <mat-cell *matCellDef="let row">
      <mat-select [(ngModel)]="row.label" (selectionChange)="onLabelChange(row)">
        <mat-option *ngFor="let label of labels" [value]="label">{{ label }}</mat-option>
      </mat-select>
    </mat-cell>
  </ng-container>

  <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
  <mat-row
    *matRowDef="let row; columns: displayedColumns;"
    [ngClass]="{'skipped-row': row.skip}">
  </mat-row>
</mat-table>

<style>
.upload-section {
  margin-bottom: 2rem;
  display: flex;
  align-items: center;
  gap: 1rem;
}
.file-name {
  font-style: italic;
  color: #555;
}
</style>
