<h2>Subir archivo XLSX</h2>
<div class="upload-section">
  <button mat-raised-button color="primary" (click)="fileInput.click()">
    <mat-icon>upload</mat-icon>
    Seleccionar archivo XLSX
  </button>
  <span *ngIf="selectedFileName" class="file-name">{{ selectedFileName }}</span>
  <input #fileInput type="file" accept=".xlsx" (change)="onFileSelected($event)" hidden />
</div>

<mat-table *ngIf="importData.length > 0" [dataSource]="importData" class="mat-elevation-z2">

  <ng-container matColumnDef="date">
    <mat-header-cell *matHeaderCellDef> Fecha </mat-header-cell>
    <mat-cell *matCellDef="let row"> {{ row.date | date:'dd/MM/yyyy' }} </mat-cell>
  </ng-container>

  <ng-container matColumnDef="description">
    <mat-header-cell *matHeaderCellDef> Descripci√≥n </mat-header-cell>
    <mat-cell *matCellDef="let row"> {{ row.description }} </mat-cell>
  </ng-container>

  <ng-container matColumnDef="amount">
    <mat-header-cell *matHeaderCellDef> Importe </mat-header-cell>
    <mat-cell *matCellDef="let row"> {{ row.amount | number:'1.2-2' }} </mat-cell>
  </ng-container>

  <ng-container matColumnDef="label">
    <mat-header-cell *matHeaderCellDef> Etiqueta </mat-header-cell>
    <mat-cell *matCellDef="let row">
      <mat-select [(ngModel)]="row.label" (selectionChange)="onLabelChange(row)">
        <mat-option *ngFor="let label of labels" [value]="label">{{ label }}</mat-option>
      </mat-select>
    </mat-cell>
  </ng-container>

  <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
  <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
</mat-table>

<style>
.upload-section {
  margin-bottom: 2rem;
  display: flex;
  align-items: center;
  gap: 1rem;
}
.file-name {
  font-style: italic;
  color: #555;
}
</style>
